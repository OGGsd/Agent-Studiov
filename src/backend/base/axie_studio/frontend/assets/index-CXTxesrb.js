import{r as c,j as e,i as j,G as K,H as Q,J as X,K as N,L as S,M as b,N as y,O as Y,I as V,Q as C,R as A,T,V as k,W as i,X as O,Y as Z,Z as ee,_ as se,a0 as te,a1 as ae,a2 as re}from"./index-DUNtuzu6.js";import{T as le,a as ie,b as R,c as _,d as ne,e as g}from"./table-D7EXerYW.js";const m={starter:{max_workflows:50,max_api_calls_per_month:5e3,max_storage_gb:1,price_per_month:29},professional:{max_workflows:200,max_api_calls_per_month:25e3,max_storage_gb:10,price_per_month:79},enterprise:{max_workflows:-1,max_api_calls_per_month:1e5,max_storage_gb:50,price_per_month:199}},ce={starter:"bg-blue-100 text-blue-800",professional:"bg-purple-100 text-purple-800",enterprise:"bg-gold-100 text-gold-800"};function me(){const[o,p]=c.useState([]),[f,E]=c.useState([]),[d,w]=c.useState(""),[v,u]=c.useState("all"),[x,$]=c.useState("all"),[M,L]=c.useState(null),[P,I]=c.useState(!1),[B,D]=c.useState(!0);c.useEffect(()=>{(async()=>{try{const t=await fetch("/api/v1/accounts",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to fetch accounts");const r=await t.json();p(r.accounts||[]),D(!1)}catch(t){console.error("Error fetching accounts:",t);const r=[],n=["starter","professional","enterprise"];for(let l=1;l<=30;l++){const a=n[Math.floor(Math.random()*n.length)];r.push({id:`account-${l}`,username:`${a}${String(l).padStart(3,"0")}@axiestudio.se`,tier:a,account_number:1e3+l,is_active:Math.random()>.2,api_calls_used_this_month:Math.floor(Math.random()*m[a].max_api_calls_per_month*.8),storage_used_gb:Math.random()*m[a].max_storage_gb*.6,workflow_count:Math.floor(Math.random()*(m[a].max_workflows===-1?100:m[a].max_workflows)*.4),created_at:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString(),last_login_at:Math.random()>.3?new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString():void 0})}p(r),D(!1)}})()},[]),c.useEffect(()=>{let s=o;d&&(s=s.filter(t=>t.username.toLowerCase().includes(d.toLowerCase())||t.account_number.toString().includes(d))),v!=="all"&&(s=s.filter(t=>t.tier===v)),x!=="all"&&(s=s.filter(t=>x==="active"?t.is_active:!t.is_active)),E(s)},[o,d,v,x]);const U=s=>{L(s),I(!0)},H=async s=>{try{if(!(await fetch(`/api/v1/users/${s.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({username:s.username,tier:s.tier,is_active:s.is_active})})).ok)throw new Error("Failed to update account");p(r=>r.map(n=>n.id===s.id?s:n)),I(!1),L(null),alert("Account updated successfully!")}catch(t){console.error("Error updating account:",t),alert("Failed to update account. Please try again.")}},z=s=>{confirm("Are you sure you want to delete this account?")&&p(t=>t.filter(r=>r.id!==s))},G=()=>{const t=[["username","tier","account_number","is_active","api_calls_used_this_month","storage_used_gb","workflow_count"].join(","),...f.map(a=>[a.username,a.tier,a.account_number,a.is_active,a.api_calls_used_this_month,a.storage_used_gb,a.workflow_count].join(","))].join(`
`),r=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download=`axie_studio_accounts_${new Date().toISOString().split("T")[0]}.csv`,l.click(),window.URL.revokeObjectURL(n)},J=()=>{const s=document.createElement("input");s.type="file",s.accept=".csv",s.onchange=t=>{var n;const r=(n=t.target.files)==null?void 0:n[0];if(r){const l=new FileReader;l.onload=a=>{var F;const q=(F=a.target)==null?void 0:F.result;console.log("CSV imported:",q),alert("CSV import functionality would be implemented here")},l.readAsText(r)}},s.click()},W=async()=>{if(confirm("This will import all 600 pre-configured accounts. Continue?"))try{alert("Account import functionality would be implemented here")}catch{alert("Failed to import accounts")}},h={total:o.length,active:o.filter(t=>t.is_active).length,starter:o.filter(t=>t.tier==="starter").length,professional:o.filter(t=>t.tier==="professional").length,enterprise:o.filter(t=>t.tier==="enterprise").length,potential_revenue:o.reduce((t,r)=>t+m[r.tier].price_per_month,0)};return B?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg",children:"Loading accounts..."})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Account Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your 600 pre-configured Axie Studio accounts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",className:"flex items-center gap-2",onClick:G,children:[e.jsx(K,{className:"w-4 h-4"}),"Export CSV"]}),e.jsxs(j,{variant:"outline",className:"flex items-center gap-2",onClick:J,children:[e.jsx(Q,{className:"w-4 h-4"}),"Import CSV"]}),e.jsxs(j,{variant:"primary",className:"flex items-center gap-2",onClick:W,children:[e.jsx(X,{className:"w-4 h-4"}),"Import All Accounts"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(N,{children:[e.jsx(S,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium",children:"Total Accounts"})}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.total}),e.jsxs("p",{className:"text-xs text-gray-600",children:[h.active," active"]})]})]}),e.jsxs(N,{children:[e.jsx(S,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium",children:"Potential Revenue"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",h.potential_revenue.toLocaleString()]}),e.jsx("p",{className:"text-xs text-gray-600",children:"per month"})]})]}),e.jsxs(N,{children:[e.jsx(S,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium",children:"Tier Distribution"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Starter:"}),e.jsx("span",{children:h.starter})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Professional:"}),e.jsx("span",{children:h.professional})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Enterprise:"}),e.jsx("span",{children:h.enterprise})]})]})})]}),e.jsxs(N,{children:[e.jsx(S,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium",children:"Active Rate"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(h.active/h.total*100),"%"]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[h.active," of ",h.total]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-64",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(V,{placeholder:"Search by username or account number...",value:d,onChange:s=>w(s.target.value),className:"pl-10"})]}),e.jsxs(C,{value:v,onValueChange:u,children:[e.jsx(A,{className:"w-40",children:e.jsx(T,{placeholder:"Filter by tier"})}),e.jsxs(k,{children:[e.jsx(i,{value:"all",children:"All Tiers"}),e.jsx(i,{value:"starter",children:"Starter"}),e.jsx(i,{value:"professional",children:"Professional"}),e.jsx(i,{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs(C,{value:x,onValueChange:$,children:[e.jsx(A,{className:"w-40",children:e.jsx(T,{placeholder:"Filter by status"})}),e.jsxs(k,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs(N,{children:[e.jsx(S,{children:e.jsxs(b,{children:["Accounts (",f.length,")"]})}),e.jsx(y,{children:e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(R,{children:[e.jsx(_,{children:"Account"}),e.jsx(_,{children:"Tier"}),e.jsx(_,{children:"Status"}),e.jsx(_,{children:"Usage"}),e.jsx(_,{children:"Last Login"}),e.jsx(_,{children:"Actions"})]})}),e.jsx(ne,{children:f.map(s=>e.jsxs(R,{children:[e.jsx(g,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.username}),e.jsxs("div",{className:"text-sm text-gray-600",children:["#",s.account_number]})]})}),e.jsx(g,{children:e.jsx(O,{className:ce[s.tier],children:s.tier.charAt(0).toUpperCase()+s.tier.slice(1)})}),e.jsx(g,{children:e.jsx(O,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:["API: ",s.api_calls_used_this_month.toLocaleString(),"/",m[s.tier].max_api_calls_per_month.toLocaleString()]}),e.jsxs("div",{className:"text-sm",children:["Storage: ",s.storage_used_gb.toFixed(1),"GB/",m[s.tier].max_storage_gb,"GB"]}),e.jsxs("div",{className:"text-sm",children:["Workflows: ",s.workflow_count,"/",m[s.tier].max_workflows===-1?"âˆž":m[s.tier].max_workflows]})]})}),e.jsx(g,{children:s.last_login_at?e.jsx("div",{className:"text-sm",children:new Date(s.last_login_at).toLocaleDateString()}):e.jsx("div",{className:"text-sm text-gray-400",children:"Never"})}),e.jsx(g,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>U(s),children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>z(s.id),children:e.jsx(ee,{className:"w-4 h-4"})})]})})]},s.id))})]})})]}),M&&e.jsx(oe,{account:M,isOpen:P,onClose:()=>I(!1),onSave:H})]})}function oe({account:o,isOpen:p,onClose:f,onSave:E}){const[d,w]=c.useState(o),v=()=>{E(d)};return e.jsx(se,{open:p,onOpenChange:f,children:e.jsxs(te,{className:"max-w-md",children:[e.jsx(ae,{children:e.jsx(re,{children:"Edit Account"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Username"}),e.jsx(V,{value:d.username,onChange:u=>w(x=>({...x,username:u.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tier"}),e.jsxs(C,{value:d.tier,onValueChange:u=>w(x=>({...x,tier:u})),children:[e.jsx(A,{children:e.jsx(T,{})}),e.jsxs(k,{children:[e.jsx(i,{value:"starter",children:"Starter ($29/month)"}),e.jsx(i,{value:"professional",children:"Professional ($79/month)"}),e.jsx(i,{value:"enterprise",children:"Enterprise ($199/month)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(C,{value:d.is_active?"active":"inactive",onValueChange:u=>w(x=>({...x,is_active:u==="active"})),children:[e.jsx(A,{children:e.jsx(T,{})}),e.jsxs(k,{children:[e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(j,{variant:"outline",onClick:f,children:"Cancel"}),e.jsx(j,{onClick:v,children:"Save Changes"})]})]})]})})}export{me as default};
